)%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,weather)
)
)
)
)
)#%>% #creating numerical code for different weather conditions
#filter(weather!=c("5","6"))
#---- 1 dataframe we could use
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,weather)
)
)
)
)
)#%>% #creating numerical code for different weather conditions
#filter(weather!=c("5","6"))
#---- 1 dataframe we could use
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
filter(weather!=c("5","6"))
#different ways to check number of observations for things
#filter(numb_fatal_injr!="0")
#filter(severity=="1")
#none injured = 0, non fatal = 1, fatal = 2
#removed unreported or unknown
#---- 1 dataframe we could use
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,weather)
)
)
)
)
)%>% #creating numerical code for different weather conditions
filter(weather!="5")
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,weather)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))
#---- 1 dataframe we could use
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))
print(length(weather=="5"))
print(length(weather=="0"))
%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")%>%
mutate(as.Date(date))
library(dplyr)
library(readxl)
library(tidyr)
library(stringr)
library(stringi)
library(lubridate)
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")%>%
mutate(as_date(date))
#---- 1 dataframe we could use
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")%>%
mutate(date=mdy(date))
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")%>%
mutate(date=ymd(date))
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")%>%
mutate(date = as.Date(date, format= "%Y/%m/%d"))
#different ways to check number of observations for things
#filter(numb_fatal_injr!="0")
#filter(severity=="1")
#none injured = 0, non fatal = 1, fatal = 2
#removed unreported or unknown
#---- 1 dataframe we could use
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")%>%
mutate(date = as.Date(date, format= "%m/%d/%Y"))
data_munge2 = select(data,-c(dist_dirc_exit, age, max_injr_svrty_cl,
numb_fatal_injr, numb_nonfatal_injr,injy_stat_descr,
vehc_unit_numb,crash_status,max_injr_svrty_vl, pers_numb))%>%
filter(!is.na(speed_limit))%>% #filter out anything without speed limit
rename("severity" = "crash_severity_descr")%>% #changed column name
rename("weather" = "weath_cond_descr")%>%
mutate(severity=ifelse(severity=="Property damage only (none injured)",0,
ifelse(severity=="Non-fatal injury",1,ifelse(severity=="Fatal injury",2,3)
)
)
)%>%
filter(severity!="3")%>% #remove any unreported or unknown severity levels
drop_na()%>% #drop any row with NA
mutate(weather = ifelse(weather =="Clear/Clear","Clear",ifelse(weather == "Rain/Rain","Rain",
ifelse(weather=="Not Reported","Unknown",ifelse(weather=="Snow/Snow","Snow",
ifelse(weather=="Cloudy/Rain","Rain",ifelse(weather=="Clear/Cloudy", "Cloudy",
ifelse(weather=="Snow/Cloudy","Snow",ifelse(weather=="Clear/Blowing sand, snow","Snow",
ifelse(weather=="Rain/Sleet, hail (freezing rain or drizzle)","Rain", ifelse(weather=="Snow/Blowing sand, snow", "Snow",
ifelse(weather=="Clear/Rain","Rain",ifelse(weather=="Cloudy/Cloudy","Cloudy",
ifelse(weather=="Rain/Cloudy","Rain",ifelse(weather=="Rain/Severe crosswinds","Rain",
ifelse(weather=="Snow/Sleet, hail (freezing rain or drizzle)", "Snow",weather)))))))))))
)))))%>% #concatenating weather conditions
mutate(weather=ifelse(weather=="Clear",0,
ifelse(weather=="Cloudy",1,ifelse(weather=="Snow",2,
ifelse(weather=="Rain",3,
ifelse(weather=="Unknown",5,6)
)
)
)
)
)%>% #creating numerical code for different weather conditions
#filter(weather!="5")
filter(weather!=c("5","6"))%>% #filtering out any unknown or other weather descriptions that are not frequently used/ambiguous
rename("date"="crash_date")%>%
mutate(date = as.Date(date, format= "%m-%d-%Y"))
